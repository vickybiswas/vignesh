(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{3999:(e,t,s)=>{"use strict";s.d(t,{N:()=>i,U:()=>o,cn:()=>n});var a=s(8828),r=s(2596),l=s(9688);function n(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,l.QP)((0,r.$)(t))}function o(e){return e&&"string"==typeof e?/[\\\/:*?"<>|\s]/.test(e)?{isValid:!1,error:a.D.fileNameFormatError}:""===e.trim()?{isValid:!1,error:a.D.fileNameCannotEmptyOrContainWhitespace}:e.length>255?{isValid:!1,error:a.D.fileNameLengthError}:{isValid:!0,error:null}:{isValid:!1,error:a.D.fileNameStringError}}function i(e){if(!e||"string"!=typeof e)return"";let t=e.trim();return t.toLowerCase().endsWith(".txt")?t:"".concat(t,".txt")}},5041:(e,t,s)=>{Promise.resolve().then(s.bind(s,9035))},5204:(e,t,s)=>{"use strict";s.d(t,{Ke:()=>n,Nt:()=>r,R6:()=>l});var a=s(8106);let r=a.bL,l=a.R6,n=a.Ke},6891:(e,t,s)=>{"use strict";s.d(t,{F:()=>o});var a=s(5155),r=s(2115),l=s(7655),n=s(3999);let o=r.forwardRef((e,t)=>{let{className:s,children:r,...o}=e;return(0,a.jsxs)(l.bL,{ref:t,className:(0,n.cn)("relative overflow-hidden",s),...o,children:[(0,a.jsx)(l.LM,{className:"h-full w-full rounded-[inherit]",children:r}),(0,a.jsx)(i,{}),(0,a.jsx)(l.OK,{})]})});o.displayName=l.bL.displayName;let i=r.forwardRef((e,t)=>{let{className:s,orientation:r="vertical",...o}=e;return(0,a.jsx)(l.VM,{ref:t,orientation:r,className:(0,n.cn)("flex touch-none select-none transition-colors","vertical"===r&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===r&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",s),...o,children:(0,a.jsx)(l.lr,{className:"relative flex-1 rounded-full bg-border"})})});i.displayName=l.VM.displayName},7168:(e,t,s)=>{"use strict";s.d(t,{$:()=>c});var a=s(5155),r=s(2115),l=s(9708),n=s(2085),o=s(3999);let i=(0,n.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=r.forwardRef((e,t)=>{let{className:s,variant:r,size:n,asChild:c=!1,...d}=e,u=c?l.DX:"button";return(0,a.jsx)(u,{className:(0,o.cn)(i({variant:r,size:n,className:s})),ref:t,...d})});c.displayName="Button"},7808:(e,t,s)=>{"use strict";s.d(t,{$:()=>n});var a=s(5155),r=s(2138),l=s(8482);function n(e){let{text:t,start:s,stop:n,isHighlighted:o,onClick:i,fileId:c}=e;return(0,a.jsx)(l.Zp,{className:"cursor-pointer hover:bg-accent ".concat(o?"bg-green-200":""),onClick:i,children:(0,a.jsx)(l.Wu,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-start gap-2",children:[(0,a.jsx)("div",{className:"mt-1.5 shrink-0",children:(0,a.jsx)(r.A,{className:"h-4 w-4 text-muted-foreground"})}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("p",{className:"font-mono text-sm",children:["Position: ",s," → ",n,c&&(0,a.jsxs)("span",{className:"ml-2 text-muted-foreground",children:["(",c,")"]})]}),(0,a.jsx)("div",{className:"rounded border bg-muted p-2",children:(0,a.jsxs)("p",{className:"text-sm",children:["“",t,"”"]})})]})]})})})}},8482:(e,t,s)=>{"use strict";s.d(t,{Wu:()=>c,ZB:()=>i,Zp:()=>n,aR:()=>o});var a=s(5155),r=s(2115),l=s(3999);let n=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,l.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",s),...r})});n.displayName="Card";let o=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,l.cn)("flex flex-col space-y-1.5 p-6",s),...r})});o.displayName="CardHeader";let i=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,l.cn)("text-2xl font-semibold leading-none tracking-tight",s),...r})});i.displayName="CardTitle",r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,l.cn)("text-sm text-muted-foreground",s),...r})}).displayName="CardDescription";let c=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,l.cn)("p-6 pt-0",s),...r})});c.displayName="CardContent",r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,l.cn)("flex items-center p-6 pt-0",s),...r})}).displayName="CardFooter"},8828:(e,t,s)=>{"use strict";s.d(t,{D:()=>a});let a={deleteFileWarningMessage:"This deletion can't be recover, are you sure you want to delete this file?",fileExistWithSameName:"File already exist with same name.",fileNameStringError:"Filename must be a non-empty string.",fileNameFormatError:'Filename cannot contain spaces or special characters (\\ / : * ? " < > |).',fileNameCannotEmptyOrContainWhitespace:"Filename cannot be empty or whitespace.",fileNameLengthError:"Filename cannot be longer than 255 characters."}},9035:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>tc});var a=s(5155),r=s(2115),l=s(7168),n=s(3999);let o=r.forwardRef((e,t)=>{let{className:s,type:r,...l}=e;return(0,a.jsx)("input",{type:r,className:(0,n.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:t,...l})});o.displayName="Input";var i=s(5452),c=s(4416);let d=i.bL;i.l9;let u=i.ZL;i.bm;let m=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(i.hJ,{ref:t,className:(0,n.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...r})});m.displayName=i.hJ.displayName;let f=r.forwardRef((e,t)=>{let{className:s,children:r,...l}=e;return(0,a.jsxs)(u,{children:[(0,a.jsx)(m,{}),(0,a.jsxs)(i.UC,{ref:t,className:(0,n.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...l,children:[r,(0,a.jsxs)(i.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,a.jsx)(c.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});f.displayName=i.UC.displayName;let h=e=>{let{className:t,...s}=e;return(0,a.jsx)("div",{className:(0,n.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...s})};h.displayName="DialogHeader";let x=e=>{let{className:t,...s}=e;return(0,a.jsx)("div",{className:(0,n.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...s})};x.displayName="DialogFooter";let p=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(i.hE,{ref:t,className:(0,n.cn)("text-lg font-semibold leading-none tracking-tight",s),...r})});p.displayName=i.hE.displayName;let j=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(i.VY,{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",s),...r})});j.displayName=i.VY.displayName;var g=s(8698),v=s(3052),b=s(5196),N=s(9428);let y=g.bL,w=g.l9;g.YJ,g.ZL;let k=g.Pb;g.z6;let C=r.forwardRef((e,t)=>{let{className:s,inset:r,children:l,...o}=e;return(0,a.jsxs)(g.ZP,{ref:t,className:(0,n.cn)("flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",r&&"pl-8",s),...o,children:[l,(0,a.jsx)(v.A,{className:"ml-auto"})]})});C.displayName=g.ZP.displayName;let S=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(g.G5,{ref:t,className:(0,n.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...r})});S.displayName=g.G5.displayName;let O=r.forwardRef((e,t)=>{let{className:s,sideOffset:r=4,...l}=e;return(0,a.jsx)(g.ZL,{children:(0,a.jsx)(g.UC,{ref:t,sideOffset:r,className:(0,n.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...l})})});O.displayName=g.UC.displayName;let A=r.forwardRef((e,t)=>{let{className:s,inset:r,...l}=e;return(0,a.jsx)(g.q7,{ref:t,className:(0,n.cn)("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",r&&"pl-8",s),...l})});A.displayName=g.q7.displayName,r.forwardRef((e,t)=>{let{className:s,children:r,checked:l,...o}=e;return(0,a.jsxs)(g.H_,{ref:t,className:(0,n.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),checked:l,...o,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(g.VF,{children:(0,a.jsx)(b.A,{className:"h-4 w-4"})})}),r]})}).displayName=g.H_.displayName,r.forwardRef((e,t)=>{let{className:s,children:r,...l}=e;return(0,a.jsxs)(g.hN,{ref:t,className:(0,n.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...l,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(g.VF,{children:(0,a.jsx)(N.A,{className:"h-2 w-2 fill-current"})})}),r]})}).displayName=g.hN.displayName;let E=r.forwardRef((e,t)=>{let{className:s,inset:r,...l}=e;return(0,a.jsx)(g.JU,{ref:t,className:(0,n.cn)("px-2 py-1.5 text-sm font-semibold",r&&"pl-8",s),...l})});E.displayName=g.JU.displayName;let T=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(g.wv,{ref:t,className:(0,n.cn)("-mx-1 my-1 h-px bg-muted",s),...r})});T.displayName=g.wv.displayName;var R=s(1007),L=s(2098),I=s(3509),z=s(9803),$=s(1362);function _(){let[e,t]=(0,r.useState)(!1),[s,n]=(0,r.useState)(""),{setTheme:i,theme:c}=(0,$.D)();return(0,r.useEffect)(()=>{let e=localStorage.getItem("openai_api_key");e&&n(e)},[]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(y,{children:[(0,a.jsx)(w,{asChild:!0,children:(0,a.jsx)(l.$,{variant:"ghost",className:"w-8 h-8 rounded-full",children:(0,a.jsx)(R.A,{className:"h-4 w-4"})})}),(0,a.jsxs)(O,{align:"end",children:[(0,a.jsx)(E,{children:"Vicky Biswas"}),(0,a.jsx)(T,{}),(0,a.jsxs)(A,{onClick:()=>{i("dark"===c?"light":"dark")},children:["dark"===c?(0,a.jsx)(L.A,{className:"mr-2 h-4 w-4"}):(0,a.jsx)(I.A,{className:"mr-2 h-4 w-4"}),"Toggle theme"]}),(0,a.jsxs)(A,{onClick:()=>t(!0),children:[(0,a.jsx)(z.A,{className:"mr-2 h-4 w-4"}),"Set OpenAI API Key"]})]})]}),(0,a.jsx)(d,{open:e,onOpenChange:t,children:(0,a.jsxs)(f,{children:[(0,a.jsxs)(h,{children:[(0,a.jsx)(p,{children:"Set OpenAI API Key"}),(0,a.jsx)(j,{children:"Enter your OpenAI API key to enable AI-powered features."})]}),(0,a.jsx)(o,{type:"password",placeholder:"Enter your API key",value:s,onChange:e=>n(e.target.value)}),(0,a.jsx)(l.$,{onClick:()=>{localStorage.setItem("openai_api_key",s),t(!1)},children:"Save"})]})})]})}var F=s(6474),D=s(5112),P=s(4616),B=s(1788),M=s(9869),U=s(9613);let W=U.Kq,V=U.bL,Z=U.l9,J=r.forwardRef((e,t)=>{let{className:s,sideOffset:r=4,...l}=e;return(0,a.jsx)(U.UC,{ref:t,sideOffset:r,className:(0,n.cn)("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...l})});J.displayName=U.UC.displayName;let K=0,G=new Map,H=e=>{if(G.has(e))return;let t=setTimeout(()=>{G.delete(e),Q({type:"REMOVE_TOAST",toastId:e})},1e6);G.set(e,t)},Y=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:s}=t;return s?H(s):e.toasts.forEach(e=>{H(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===s||void 0===s?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},X=[],q={toasts:[]};function Q(e){q=Y(q,e),X.forEach(e=>{e(q)})}function ee(e){let{...t}=e,s=(K=(K+1)%Number.MAX_SAFE_INTEGER).toString(),a=()=>Q({type:"DISMISS_TOAST",toastId:s});return Q({type:"ADD_TOAST",toast:{...t,id:s,open:!0,onOpenChange:e=>{e||a()}}}),{id:s,dismiss:a,update:e=>Q({type:"UPDATE_TOAST",toast:{...e,id:s}})}}function et(){let e=Math.floor(360*Math.random());return"hsl(".concat(e,", 100%, 80%)")}let es="textViewerState",ea=e=>{let t=new Set;return e.filter(e=>{let s="".concat(e.id,"-").concat(e.start,"-").concat(e.end);return!t.has(s)&&(t.add(s),!0)})},er=(0,r.createContext)({});function el(e){let{children:t}=e,[s,l]=(0,r.useState)("Text Analysis Project"),[n,o]=(0,r.useState)(()=>{try{let s=localStorage.getItem(es);if(s){var e,t;let a=JSON.parse(s);if(a&&"object"==typeof a&&Object.keys(a).length>0&&(null===(e=a[Object.keys(a)[0]])||void 0===e?void 0:e.files)&&(null===(t=a[Object.keys(a)[0]])||void 0===t?void 0:t.marks))return Object.keys(a).forEach(e=>{a[e].groups&&Object.keys(a[e].groups).forEach(t=>{a[e].groups[t].color||(a[e].groups[t].color=et())})}),a;if(a&&"object"==typeof a){let e={};if(a.projectName&&a.files&&a.tags){let t=a.projectName;return e[t]={files:{},marks:{},groups:{}},a.files&&"object"==typeof a.files&&Object.entries(a.files).forEach(s=>{let[a,r]=s;r&&(e[t].files[a]={content:r.content||"",occurrences:[],dirty:!!r.dirty})}),a.tags&&"object"==typeof a.tags&&Object.entries(a.tags).forEach(s=>{let[a,r]=s;r&&(e[t].marks[a]={color:r.color||et(),type:r.type||"Tag",name:r.text||"Unnamed Tag"},r.occurrences&&Array.isArray(r.occurrences)&&r.occurrences.forEach(s=>{s&&s.fileId&&e[t].files[s.fileId]&&e[t].files[s.fileId].occurrences.push({id:a,start:s.start||0,end:s.end||0,text:s.text||""})}))}),e}}}}catch(e){console.error("Error parsing saved state:",e)}return{"Text Analysis Project":{files:{"sample.txt":{content:"This is a sample text. You can right-click on any part of this text to add tags to it, including overlapping tags.",occurrences:[]}},marks:{},groups:{}}}}),[i,c]=(0,r.useState)(()=>{let e=n[s];return e&&e.files&&Object.keys(e.files).length>0?Object.keys(e.files)[0]:""}),[d,u]=(0,r.useState)(null),[m,f]=(0,r.useState)(null),[h,x]=(0,r.useState)(""),[p,j]=(0,r.useState)(""),[g,v]=(0,r.useState)(null),[b,N]=(0,r.useState)(!1),[y,w]=(0,r.useState)(!1),[k,C]=(0,r.useState)(!1),[S,O]=(0,r.useState)(!1),[A,E]=(0,r.useState)("all"),[T,R]=(0,r.useState)(""),[L,I]=(0,r.useState)(!1),[z,$]=(0,r.useState)([]),[_,F]=(0,r.useState)([]),[D,P]=(0,r.useState)(0),{toast:B}=function(){let[e,t]=r.useState(q);return r.useEffect(()=>(X.push(t),()=>{let e=X.indexOf(t);e>-1&&X.splice(e,1)}),[e]),{...e,toast:ee,dismiss:e=>Q({type:"DISMISS_TOAST",toastId:e})}}(),[M,U]=(0,r.useState)(()=>localStorage.getItem("OPENAI_API_KEY")||""),[W,V]=(0,r.useState)(!1),Z=(0,r.useCallback)(e=>{U(e),localStorage.setItem("OPENAI_API_KEY",e),V(!1),B({title:"API Key Saved",description:"Your OpenAI API key was saved successfully."})},[B]),[J,K]=(0,r.useState)(!1),[G,H]=(0,r.useState)([]),[Y,el]=(0,r.useState)(!1),en=(0,r.useRef)(null),eo=(0,r.useRef)(null),ei=(0,r.useMemo)(()=>Object.keys(n),[n]),ec=(0,r.useMemo)(()=>n[s]||{files:{},marks:{},groups:{}},[n,s]),ed=(0,r.useMemo)(()=>ec&&ec.files&&i&&ec.files[i]||{content:"",occurrences:[]},[ec,i]),eu=(0,r.useMemo)(()=>{let e=[];return ec&&ec.groups&&Object.entries(ec.groups).forEach(t=>{let[s,a]=t;e.push({id:s,name:a.name,color:a.color||et(),marks:a.marks||[]})}),e},[ec]);(0,r.useEffect)(()=>{localStorage.setItem(es,JSON.stringify(n))},[n]);let em=(0,r.useCallback)(e=>{if(!e||!i||!ec.files[i]||Object.entries(ec.marks||{}).find(t=>{let[s,a]=t;return"Search"===a.type&&a.name.toLowerCase()===e.toLowerCase()}))return;let t=ec.files[i].content,a=[],r=t.toLowerCase().indexOf(e.toLowerCase()),l=0,n="temp-search-".concat(e.replace(/\s+/g,"-").toLowerCase());for(;-1!==r&&(a.push({id:n,text:t.slice(r,r+e.length),start:r,end:r+e.length}),r=t.toLowerCase().indexOf(e.toLowerCase(),r+1),!(++l>1e3)););a.length>0&&o(e=>{let t={...e},r={...t[s]},l={...r.files[i],occurrences:[...(r.files[i].occurrences||[]).filter(e=>!e.id.startsWith("temp-")),...a]};return r.files={...r.files,[i]:l},t[s]=r,t})},[i,ec,s]),ef=(0,r.useCallback)(e=>{R(e),e?em(e):o(e=>{let t={...e},a={...t[s]};if(i&&a.files[i]){let e={...a.files[i],occurrences:(a.files[i].occurrences||[]).filter(e=>!e.id.startsWith("temp-"))};a.files={...a.files,[i]:e},t[s]=a}return t})},[i,em,s]),eh=(0,r.useCallback)(e=>{e.preventDefault();let t=window.getSelection();if(!t||0===t.toString().length||!en.current)return;let s=t.getRangeAt(0),a=s.cloneRange();a.selectNodeContents(en.current),a.setEnd(s.startContainer,s.startOffset);let r=a.toString().length,l=r+t.toString().length;r!==l&&(u({start:r,end:l}),f({x:e.clientX,y:e.clientY}))},[]),ex=(0,r.useCallback)(function(e){var t;let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Tag";if(!d||!e.trim()||!i)return;let r=ed.content.slice(d.start,d.end),l="".concat(a.toLowerCase(),"-").concat(e.replace(/\s+/g,"-").toLowerCase(),"-").concat(Date.now()),n=null===(t=Object.entries(ec.marks||{}).find(t=>{let[s,r]=t;return r.type===a&&r.name.toLowerCase()===e.toLowerCase()}))||void 0===t?void 0:t[0];o(t=>{let o={...t},c={...o[s]};n||(c.marks={...c.marks,[l]:{color:et(),type:a,name:e}});let u=ea([...c.files[i].occurrences||[],{id:n||l,start:d.start,end:d.end,text:r}]),m={...c.files[i],occurrences:u};return c.files={...c.files,[i]:m},o[s]=c,o}),u(null),f(null)},[i,ed,ec.marks,s,d]),ep=(0,r.useCallback)(()=>{N(!0)},[]),ej=(0,r.useCallback)(()=>{h.trim()&&(ex(h),x(""),N(!1))},[ex,h]),eg=(0,r.useMemo)(()=>T&&i&&ed?(ed.occurrences||[]).filter(e=>{var t;let s=null===(t=ec.marks)||void 0===t?void 0:t[e.id];return(null==s?void 0:s.type)==="Search"&&s.name.toLowerCase()===T.toLowerCase()||e.id.startsWith("temp-")&&e.id.includes(T.toLowerCase())}):[],[i,ed,ec.marks,T]),ev=(0,r.useCallback)(()=>{var e;if(!T||0===eg.length)return;let t="search-".concat(T.replace(/\s+/g,"-").toLowerCase(),"-").concat(Date.now());(null===(e=Object.entries(ec.marks||{}).find(e=>{let[t,s]=e;return"Search"===s.type&&s.name.toLowerCase()===T.toLowerCase()}))||void 0===e?void 0:e[0])||o(e=>{let a={...e},r={...a[s]};r.marks={...r.marks,[t]:{color:et(),type:"Search",name:T}};let l=T.trim().toLowerCase().replace(/\s+/g,"-"),n="temp-search-".concat(l);return Object.entries(r.files).forEach(e=>{let[s,a]=e,l=a.content||"",o=(a.occurrences||[]).filter(e=>!e.id.startsWith(n)),i=[],c=l.toLowerCase().indexOf(T.toLowerCase()),d=0;for(;-1!==c&&d<1e4;)i.push({id:t,text:l.slice(c,c+T.length),start:c,end:c+T.length}),c=l.toLowerCase().indexOf(T.toLowerCase(),c+1),d++;r.files[s]={...a,occurrences:ea([...o,...i])}}),a[s]=r,a})},[ec.marks,s,T]),eb=(0,r.useMemo)(()=>{let e=[];return Object.values(ec.marks||{}).forEach(t=>{"Tag"!==t.type||e.includes(t.name)||e.push(t.name)}),e},[ec.marks]),eN=(0,r.useMemo)(()=>{let e=[];return Object.entries(ec.marks||{}).forEach(t=>{let[s,a]=t;"Search"===a.type&&e.push({id:s,name:a.name,color:a.color})}),e},[ec.marks]),ey=(0,r.useCallback)(e=>{i&&o(t=>{let a={...t},r={...a[s]};if(r.files[i]){let t={...r.files[i],content:e,dirty:!0};r.files={...r.files,[i]:t},a[s]=r}return a})},[i,s]),ew=(0,r.useCallback)(e=>{c(e),E("all"),R("")},[]),ek=(0,r.useCallback)((e,t)=>{var a;console.log(e,"fileName"),console.log(t,"content"),(null===(a=ec.files)||void 0===a?void 0:a[e])||(o(a=>{let r={...a},l={...r[s]};return l.files={...l.files,[e]:{content:t,occurrences:[],dirty:!0}},r[s]=l,r}),c(e))},[ec.files,s]),eC=(0,r.useCallback)(e=>{let t=new FileReader;t.onload=t=>{var s;let a=null===(s=t.target)||void 0===s?void 0:s.result;ek(e.name,a)},t.readAsText(e)},[ek]),eS=(0,r.useCallback)(e=>{E(t=>t===e?"all":e)},[]),eO=(0,r.useCallback)(e=>{R(t=>t===e?"":e),E("all")},[]),eA=(0,r.useCallback)(e=>{if(en.current){var t,s;let a=en.current,r=document.createRange(),l=null,n=0,o=null,i=0,c=e.start,d=document.createTreeWalker(a,NodeFilter.SHOW_TEXT,null);for(;d.nextNode();){let e=d.currentNode,s=(null===(t=e.textContent)||void 0===t?void 0:t.length)||0;if(c<=s){l=e,n=c;break}c-=s}c=e.end;let u=document.createTreeWalker(a,NodeFilter.SHOW_TEXT,null);for(;u.nextNode();){let e=u.currentNode,t=(null===(s=e.textContent)||void 0===s?void 0:s.length)||0;if(c<=t){o=e,i=c;break}c-=t}if(l&&o)try{r.setStart(l,n),r.setEnd(o,i);let e=r.getBoundingClientRect(),t=a.getBoundingClientRect();a.scrollTo({top:e.top-t.top-50,behavior:"smooth"})}catch(e){console.error("Failed to scroll to occurrence:",e)}}},[]),eE=(0,r.useCallback)(e=>{E(e),R("")},[]),eT=(0,r.useCallback)(()=>{let e=new Blob([JSON.stringify(n,null,2)],{type:"application/json"}),t=URL.createObjectURL(e),a=document.createElement("a");a.href=t,a.download="".concat(s.replace(/\s+/g,"-").toLowerCase(),".json"),document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(t)},[n,s]),eR=(0,r.useCallback)(e=>{var t;let s=null===(t=e.target.files)||void 0===t?void 0:t[0];if(s){let e=new FileReader;e.onload=e=>{var t;let s=null===(t=e.target)||void 0===t?void 0:t.result;try{let e=JSON.parse(s);o(e);let t=Object.keys(e)[0];if(t){l(t);let s=Object.keys(e[t].files||{})[0];s&&c(s)}}catch(e){console.error("Error parsing uploaded state:",e),alert("Invalid state file. Please upload a valid JSON file.")}},e.readAsText(s)}},[]),eL=(0,r.useCallback)(e=>{var t;let a=null===(t=Object.entries(ec.marks||{}).find(t=>{let[s,a]=t;return"Search"===a.type&&a.name===e}))||void 0===t?void 0:t[0];a&&o(e=>{let t={...e},r={...t[s]},{[a]:l,...n}=r.marks||{};return r.marks=n,Object.keys(r.files||{}).forEach(e=>{r.files[e]={...r.files[e],occurrences:(r.files[e].occurrences||[]).filter(e=>e.id!==a)}}),Object.keys(r.groups||{}).forEach(e=>{(r.groups[e].marks||[]).includes(a)&&(r.groups[e]={...r.groups[e],marks:(r.groups[e].marks||[]).filter(e=>e!==a)})}),t[s]=r,t})},[ec.marks,s]),eI=(0,r.useCallback)(e=>{var t;o(t=>{let a={...t},r={...a[s]},{[e]:l,...n}=r.marks||{};return r.marks=n,Object.keys(r.files||{}).forEach(t=>{r.files[t]={...r.files[t],occurrences:(r.files[t].occurrences||[]).filter(t=>t.id!==e)}}),Object.keys(r.groups||{}).forEach(t=>{(r.groups[t].marks||[]).includes(e)&&(r.groups[t]={...r.groups[t],marks:(r.groups[t].marks||[]).filter(t=>t!==e)})}),a[s]=r,a});let a=null===(t=ec.marks)||void 0===t?void 0:t[e];a&&A===a.name&&E("all")},[ec.marks,s,A]),ez=(0,r.useCallback)((e,t)=>{i&&o(a=>{let r={...a},l={...r[s]},n={...l.files[i],occurrences:(l.files[i].occurrences||[]).filter(s=>s.id!==e||s.start!==t.start||s.end!==t.end)};return l.files={...l.files,[i]:n},r[s]=l,r})},[i,s]),e$=(0,r.useCallback)(e=>{var t,s;let a=new Blob([(null===(s=ec.files)||void 0===s?void 0:null===(t=s[e])||void 0===t?void 0:t.content)||""],{type:"text/plain;charset=utf-8"}),r=URL.createObjectURL(a),l=document.createElement("a");l.href=r,l.download=e,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(r)},[ec.files]),e_=(0,r.useCallback)(e=>{o(t=>{let a={...t},r={...a[s]},{[e]:l,...n}=r.files||{};return r.files=n,a[s]=r,e===i&&c(Object.keys(n)[0]||""),a})},[i,s]),eF=(0,r.useCallback)((e,t)=>{let s=Array.from(new Set(t.toLowerCase().replace(/[^\w\s]/g,"").split(/\s+/).filter(t=>t.length>3&&t!==e.toLowerCase()))).filter(t=>t!==e.toLowerCase()).slice(0,5),a=["sample","text","right","click","part","tags","overlapping"].filter(t=>t!==e.toLowerCase());return s.length<2?"text"===e.toLowerCase()?["document","content","writing","passage","material"]:"search"===e.toLowerCase()?["find","locate","discover","query","lookup"]:"tag"===e.toLowerCase()?["label","mark","category","classify","annotate"]:"sample"===e.toLowerCase()?["example","specimen","instance","case","illustration"]:a.slice(0,5):s},[]),eD=(0,r.useCallback)(async()=>{if(!M){V(!0);return}if(T&&i){el(!0),H([]),K(!0);try{var e,t,s;let a=await fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(M)},body:JSON.stringify({model:"gpt-3.5-turbo",messages:[{role:"system",content:"You are a helpful assistant that returns a JSON array of synonyms for a given word."},{role:"user",content:'List  up to 10 synonyms for the word "'.concat(T,'" as a JSON array.')}],temperature:.7,max_tokens:200})});if(!a.ok)throw Error("OpenAI error ".concat(a.status));let r=await a.json(),l=(null===(s=r.choices)||void 0===s?void 0:null===(t=s[0])||void 0===t?void 0:null===(e=t.message)||void 0===e?void 0:e.content)||"",n=[];try{let e=JSON.parse(l);if(Array.isArray(e))n=e;else if(e&&Array.isArray(e.synonyms))n=e.synonyms;else throw Error("No array found")}catch(e){n=l.replace(/[\[\]"\']+/g,"").split(/,\s*/).map(e=>e.trim()).filter(e=>e)}let o=T.toLowerCase();n=Array.from(new Set(n.map(e=>e.trim()))).filter(e=>e.toLowerCase()!==o).slice(0,10),0===n.length&&(n=eF(T,ed.content)),H(n)}catch(e){console.error("Synonyms error",e),B({title:"Synonyms failed",description:e.message||"Error fetching synonyms",variant:"destructive"}),H(eF(T,ed.content))}finally{el(!1)}}},[M,T,i,ed.content,eF]),eP=(0,r.useCallback)(e=>{if(0===e.length){K(!1);return}K(!1),o(t=>{let a={...t},r={...a[s]};return e.forEach(e=>{let t=e.toLowerCase(),s=Object.entries(r.marks||{}).find(e=>{let[,s]=e;return"Search"===s.type&&s.name.toLowerCase()===t}),a=s?s[0]:"search-".concat(t.replace(/\s+/g,"-"),"-").concat(Date.now());s||(r.marks={...r.marks,[a]:{color:et(),type:"Search",name:e}}),Object.entries(r.files||{}).forEach(s=>{let[l,n]=s,o=n.content||"",i=[],c=o.toLowerCase().indexOf(t),d=0;for(;-1!==c&&d<1e4;)i.push({id:a,text:o.slice(c,c+e.length),start:c,end:c+e.length}),c=o.toLowerCase().indexOf(t,c+1),d++;r.files[l]={...n,occurrences:ea([...n.occurrences||[],...i])}})}),a[s]=r,a})},[s]),eB=(0,r.useCallback)(()=>{if(!i||!ed.content)return null;let e=[];(ed.occurrences||[]).forEach(t=>{var s;let a=null===(s=ec.marks)||void 0===s?void 0:s[t.id];(a||t.id.startsWith("temp-"))&&e.push({start:t.start,end:t.end,markId:t.id,type:(null==a?void 0:a.type)||"Search",name:(null==a?void 0:a.name)||(t.id.startsWith("temp-")?T:"Unknown"),color:(null==a?void 0:a.color)||"hsl(200, 100%, 80%)"})}),e.sort((e,t)=>e.start-t.start);let t=[],s=new Set;e.forEach(e=>{s.add(e.start),s.add(e.end)}),s.add(0),s.add(ed.content.length);let r=Array.from(s).sort((e,t)=>e-t);for(let s=0;s<r.length-1;s++){let a=r[s],l=r[s+1];if(a===l)continue;let n=ed.content.slice(a,l),o=e.filter(e=>e.start<=a&&e.end>=l);t.push({text:n,start:a,end:l,occurrences:o})}return t.map((e,t)=>{if(0===e.occurrences.length)return(0,a.jsx)("span",{children:e.text},t);let s=e.occurrences.some(e=>"Search"===e.type&&e.name===T||"Tag"===e.type&&e.name===A),r={};if(1===e.occurrences.length)r.backgroundColor=e.occurrences[0].color,r.opacity=s?1:.5;else{let t=e.occurrences.map((t,s)=>"".concat(t.color," ").concat(100*s/e.occurrences.length,"%, ").concat(t.color," ").concat((s+1)*100/e.occurrences.length,"%")).join(", ");r.background="linear-gradient(135deg, ".concat(t,")"),r.opacity=s?1:.5}let l=e.occurrences.map(e=>"".concat(e.type,": ").concat(e.name)).join("\n");return(0,a.jsx)("mark",{style:r,title:l,className:"rounded-sm",children:e.text},t)})},[i,ed,ec.marks,T,A]),eM=(0,r.useCallback)(()=>{if(!i)return[];let e=[],t={};return(ed.occurrences||[]).forEach(e=>{var s;let a=null===(s=ec.marks)||void 0===s?void 0:s[e.id];a&&"Tag"===a.type&&(t[a.name]||(t[a.name]={id:e.id,color:a.color,positions:{[i]:[]}}),t[a.name].positions[i].push({text:e.text,start:e.start,stop:e.end}))}),Object.entries(ec.marks||{}).forEach(e=>{let[s,a]=e;if("Tag"!==a.type)return;let r=a.name;t[r]?t[r].positions[i]||(t[r].positions[i]=[]):t[r]={id:s,color:a.color,positions:{[i]:[]}}}),Object.entries(t).forEach(t=>{let[s,a]=t;e.push({id:a.id,text:s,color:a.color,positions:a.positions})}),e},[i,ed.occurrences,ec.marks]),eU=(0,r.useCallback)(()=>{if(!i)return[];let e={};return Object.entries(ec.marks||{}).forEach(t=>{let[s,a]=t;"Search"===a.type&&(e[a.name]={id:s,color:a.color,occurrences:[]})}),(ed.occurrences||[]).forEach(t=>{var s;let a=null===(s=ec.marks)||void 0===s?void 0:s[t.id];if(!a||"Search"!==a.type)return;let r=a.name;e[r]||(e[r]={id:t.id,color:a.color,occurrences:[]}),e[r].occurrences.push({text:t.text,start:t.start,stop:t.end})}),Object.entries(e).map(e=>{let[t,s]=e;return{id:s.id,text:t,color:s.color,occurrences:s.occurrences}})},[i,ed.occurrences,ec.marks]),eW=(0,r.useCallback)(e=>{e.preventDefault(),em(T)},[em,T]),eV=(0,r.useCallback)(e=>{e.trim()&&!n[e]&&(o(t=>{let s={...t};return s[e]={files:{"sample.txt":{content:"This is a sample text for your new project.",occurrences:[]}},marks:{},groups:{}},s}),l(e),c("sample.txt"))},[n]),eZ=(0,r.useCallback)(e=>{n[e]&&(l(e),c(Object.keys(n[e].files||{})[0]||""),E("all"),R(""))},[n]),eJ=(0,r.useCallback)((e,t)=>{if(!e.trim()||!t.trim()||e===t||n[t])return;let a={...n},r=a[e];r&&(delete a[e],a[t]=r,o(a),s===e&&l(t))},[n,s]),eK=(0,r.useCallback)(e=>{if(!n[e])return;let t={...n};if(delete t[e],o(t),s===e){let e=Object.keys(t)[0]||"";if(l(e),e){let s=t[e].files;c(s&&Object.keys(s)[0]?Object.keys(s)[0]:"")}else c("")}},[n,s]),eG=(0,r.useCallback)(e=>{if(!e.trim())return;let t="group-".concat(e.replace(/\s+/g,"-").toLowerCase(),"-").concat(Date.now());return o(a=>{let r={...a},l={...r[s]};return l.groups={...l.groups,[t]:{name:e,marks:[],color:et()}},r[s]=l,r}),t},[s]),eH=(0,r.useCallback)((e,t)=>{o(a=>{var r,l;let n={...a},o={...n[s]};return(null===(r=o.groups)||void 0===r?void 0:r[e])&&(null===(l=o.marks)||void 0===l?void 0:l[t])&&!(o.groups[e].marks||[]).includes(t)&&(o.groups[e]={...o.groups[e],marks:[...o.groups[e].marks||[],t]}),n[s]=o,n})},[s]),eY=(0,r.useCallback)((e,t)=>{o(a=>{var r;let l={...a},n={...l[s]};return(null===(r=n.groups)||void 0===r?void 0:r[e])&&(n.groups[e]={...n.groups[e],marks:(n.groups[e].marks||[]).filter(e=>e!==t)}),l[s]=n,l})},[s]),eX=(0,r.useCallback)(e=>{o(t=>{let a={...t},r={...a[s]};if(r.groups){let{[e]:t,...s}=r.groups;r.groups=s}return a[s]=r,a})},[s]),eq=(0,r.useCallback)((e,t)=>{o(a=>{var r;let l={...a},n={...l[s]};return(null===(r=n.groups)||void 0===r?void 0:r[e])&&(n.groups[e]={...n.groups[e],marks:t}),l[s]=n,l})},[s]),eQ=(0,r.useCallback)(e=>{var t;let s=null===(t=ec.groups)||void 0===t?void 0:t[e];return s?(s.marks||[]).map(e=>{var t;let s=null===(t=ec.marks)||void 0===t?void 0:t[e];return s?{id:e,name:s.name,type:s.type,color:s.color}:null}).filter(Boolean):[]},[ec.groups,ec.marks]),e0=(0,r.useCallback)(()=>{let e=[];return Object.entries(ec.marks||{}).forEach(t=>{let[s,a]=t;"Tag"===a.type&&e.push({id:s,name:a.name,prefix:"Tag",color:a.color})}),Object.entries(ec.marks||{}).forEach(t=>{let[s,a]=t;"Search"===a.type&&e.push({id:s,name:a.name,prefix:"Search",color:a.color})}),Object.entries(ec.groups||{}).forEach(t=>{let[s,a]=t;e.push({id:s,name:a.name,prefix:"Group",color:a.color||et()})}),e},[ec.marks,ec.groups]),e1=(0,r.useCallback)(()=>{O(!0),setTimeout(()=>{o(e=>{let t={...e},a={...t[s]},r=a.marks||{},l=Object.entries(r).filter(e=>{let[,t]=e;return"Search"===t.type});return Object.entries(a.files||{}).forEach(e=>{let[t,s]=e,n=s.content||"",o=[...(s.occurrences||[]).filter(e=>{let t=r[e.id];return!t||"Search"!==t.type})];l.forEach(e=>{let[t,s]=e,a=s.name,r=n.toLowerCase().indexOf(a.toLowerCase()),l=0;for(;-1!==r&&l<1e3;)o.push({id:t,text:n.slice(r,r+a.length),start:r,end:r+a.length}),r=n.toLowerCase().indexOf(a.toLowerCase(),r+1),l++}),a.files[t]={...s,occurrences:ea(o)}}),t[s]=a,t}),O(!1)},200)},[s]);return(0,a.jsx)(er.Provider,{value:{state:n,projectName:s,setProjectName:l,projectNames:ei,currentProject:ec,activeFile:i,setActiveFile:c,currentFile:ed,selectedTagFilter:A,setSelectedTagFilter:E,searchTerm:T,setSearchTerm:ef,showTabulationView:L,setShowTabulationView:I,tabulationRowSelections:z,setTabulationRowSelections:$,tabulationColumnSelections:_,setTabulationColumnSelections:F,tabulationExpansionType:D,setTabulationExpansionType:P,showSynonymsPopup:J,setShowSynonymsPopup:K,synonyms:G,setSynonyms:H,isFetchingSynonyms:Y,setIsFetchingSynonyms:el,isNewTagDialogOpen:b,setIsNewTagDialogOpen:N,isNewGroupDialogOpen:y,setIsNewGroupDialogOpen:w,isEditGroupDialogOpen:k,setIsEditGroupDialogOpen:C,isRefreshingSearch:S,setIsRefreshingSearch:O,newTagLabel:h,setNewTagLabel:x,newGroupName:p,setNewGroupName:j,selectedGroupForEdit:g,setSelectedGroupForEdit:v,contentRef:en,fileInputRef:eo,selection:d,setSelection:u,contextMenuPosition:m,setContextMenuPosition:f,searchResults:eg,uniqueTagLabels:eb,savedSearches:eN,groups:eu,handleSelectFile:ew,handleAddFile:ek,handleUploadFile:eC,handleSaveFile:e$,handleRemoveFile:e_,handleTagClick:eS,handleSearchClick:eO,handleSpecificSearchClick:eA,handleTagFilterChange:eE,handleContentChange:ey,handleContextMenu:eh,addTag:ex,handleNewTag:ep,submitNewTag:ej,saveSearch:ev,fetchSynonyms:eD,handleSaveSynonyms:eP,handleDownloadState:eT,handleUploadState:eR,handleRemoveSearch:eL,handleRemoveTag:eI,handleRemoveOccurrence:ez,renderContent:eB,prepareTagsForAnalysis:eM,prepareSearchesForAnalysis:eU,handleSearch:eW,createNewProject:eV,switchProject:eZ,updateProjectName:eJ,deleteProject:eK,createGroup:eG,addMarkToGroup:eH,removeMarkFromGroup:eY,deleteGroup:eX,updateGroupMarks:eq,refreshAllSearches:e1,getMarksByGroup:eQ,getAllMarksForTabulation:e0,apiKey:M,showApiKeyDialog:W,setShowApiKeyDialog:V,handleSaveApiKey:Z},children:t})}function en(){let{projectName:e,projectNames:t,handleDownloadState:s,handleUploadState:n,showTabulationView:i,setShowTabulationView:c,fileInputRef:u,createNewProject:m,switchProject:x,updateProjectName:j,deleteProject:g}=(0,r.useContext)(er),[v,b]=(0,r.useState)(!1),[N,E]=(0,r.useState)(!1),[T,R]=(0,r.useState)(e),[L,I]=(0,r.useState)(""),[z,$]=(0,r.useState)(null);return(0,a.jsxs)("div",{className:"border-b p-4",children:[(0,a.jsx)(W,{children:(0,a.jsxs)("div",{className:"flex justify-between items-center flex-wrap gap-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)(y,{children:[(0,a.jsx)(w,{asChild:!0,children:(0,a.jsxs)(l.$,{variant:"outline",className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"font-bold",children:e}),(0,a.jsx)(F.A,{className:"h-4 w-4"})]})}),(0,a.jsx)(O,{children:t.map(e=>(0,a.jsxs)(k,{children:[(0,a.jsx)(C,{children:e}),(0,a.jsxs)(S,{children:[(0,a.jsxs)(A,{onClick:()=>x(e),children:["Switch to ",e]}),(0,a.jsx)(A,{onClick:()=>{$(e),R(e),b(!0)},children:"Edit Project Name"}),(0,a.jsx)(A,{onClick:()=>g(e),children:"Delete Project"})]})]},e))})]}),(0,a.jsxs)(V,{children:[(0,a.jsx)(Z,{asChild:!0,children:(0,a.jsx)(l.$,{variant:"ghost",size:"icon",onClick:()=>c(!0),children:(0,a.jsx)(D.A,{className:"h-4 w-4"})})}),(0,a.jsx)(J,{side:"top",children:"Tabulate"})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,a.jsxs)(V,{children:[(0,a.jsx)(Z,{asChild:!0,children:(0,a.jsx)(l.$,{variant:"ghost",size:"icon",onClick:()=>E(!0),children:(0,a.jsx)(P.A,{className:"h-4 w-4"})})}),(0,a.jsx)(J,{side:"top",children:"Add Project"})]}),(0,a.jsxs)(V,{children:[(0,a.jsx)(Z,{asChild:!0,children:(0,a.jsx)(l.$,{variant:"ghost",size:"icon",onClick:s,children:(0,a.jsx)(B.A,{className:"h-4 w-4"})})}),(0,a.jsx)(J,{side:"top",children:"Download Project"})]}),(0,a.jsxs)(V,{children:[(0,a.jsx)(Z,{asChild:!0,children:(0,a.jsx)(l.$,{variant:"ghost",size:"icon",onClick:()=>{var e;return null===(e=u.current)||void 0===e?void 0:e.click()},children:(0,a.jsx)(M.A,{className:"h-4 w-4"})})}),(0,a.jsx)(J,{side:"top",children:"Upload Project"})]}),(0,a.jsx)("input",{type:"file",ref:u,onChange:n,style:{display:"none"},accept:".json"}),(0,a.jsx)(_,{})]})]})}),(0,a.jsx)(d,{open:v,onOpenChange:e=>{b(e),e||$(null)},children:(0,a.jsxs)(f,{children:[(0,a.jsx)(h,{children:(0,a.jsx)(p,{children:"Edit Project Name"})}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(o,{type:"text",placeholder:"Enter project name",value:T,onChange:e=>R(e.target.value)}),(0,a.jsx)(l.$,{onClick:()=>{T.trim()&&z&&j(z,T.trim()),b(!1),$(null)},children:"Save"})]})]})}),(0,a.jsx)(d,{open:N,onOpenChange:E,children:(0,a.jsxs)(f,{children:[(0,a.jsx)(h,{children:(0,a.jsx)(p,{children:"Create New Project"})}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(o,{type:"text",placeholder:"Enter new project name",value:L,onChange:e=>I(e.target.value)}),(0,a.jsx)(l.$,{onClick:()=>{L.trim()&&m(L),E(!1),I("")},children:"Create"})]})]})})]})}var eo=s(4126),ei=s(2335);function ec(e){let{isOpen:t,setIsOpen:s,warningMessage:r,onConfirm:n}=e;return(0,a.jsx)(d,{open:!!t,onOpenChange:s,children:(0,a.jsxs)(f,{className:"max-w-sm",children:[(0,a.jsx)(h,{children:(0,a.jsx)(p,{className:"text-red-600",children:"Warning"})}),(0,a.jsx)("div",{className:"text-center text-gray-700 py-4",children:r}),(0,a.jsxs)("div",{className:"flex justify-end gap-2 mt-4",children:[(0,a.jsx)(l.$,{variant:"outline",onClick:()=>s(""),children:"Cancel"}),(0,a.jsx)(l.$,{variant:"destructive",onClick:n,children:"Confirm"})]})]})})}var ed=s(8828);function eu(e){let{isOpen:t,setIsOpen:s,newFileName:r,setNewFileName:n,handleAddFile:i,fileAddError:c}=e;return(0,a.jsx)(d,{open:!!t,onOpenChange:s,children:(0,a.jsxs)(f,{className:"max-w-sm",children:[(0,a.jsx)(h,{children:(0,a.jsx)(p,{className:"text-black-600",children:"Add file"})}),(0,a.jsx)("div",{className:"text-center text-gray-700 py-4",children:(0,a.jsxs)("div",{className:"mt-4 space-y-2",children:[(0,a.jsx)("div",{className:"flex items-center space-x-2",children:(0,a.jsx)(o,{type:"text",placeholder:"New file name",value:r,onChange:e=>n(e.target.value),onKeyPress:e=>"Enter"===e.key&&i()})}),c&&(0,a.jsx)("div",{className:"text-red-600",children:c})]})}),(0,a.jsxs)("div",{className:"flex justify-end gap-2 mt-4",children:[(0,a.jsx)(l.$,{variant:"outline",onClick:()=>s(""),children:"Cancel"}),(0,a.jsx)(l.$,{onClick:i,children:"Add"})]})]})})}function em(){let{currentProject:e,activeFile:t,handleSelectFile:s,handleAddFile:o,handleUploadFile:i,handleSaveFile:c,handleRemoveFile:d}=(0,r.useContext)(er),[u,m]=(0,r.useState)(""),[f,h]=(0,r.useState)(""),[x,p]=(0,r.useState)(!1),[j,g]=(0,r.useState)(""),v=(0,r.useRef)(null),b=e=>{h(e)},N=e=>{d(e),h("")},[y,w]=(0,r.useState)(!1),k=(0,r.useCallback)(e=>{e.preventDefault(),e.dataTransfer.dropEffect="copy"},[]),C=(0,r.useCallback)(e=>{e.preventDefault(),w(!0)},[]),S=(0,r.useCallback)(e=>{e.preventDefault(),w(!1)},[]),O=(0,r.useCallback)(e=>{e.preventDefault(),w(!1),Array.from(e.dataTransfer.files).forEach(e=>i(e))},[i]),A=(null==e?void 0:e.files)||{};return(0,a.jsxs)("div",{className:"border-r p-2 md:p-4 h-full flex flex-col overflow-auto min-h-0 ".concat(y?"bg-blue-50 border-dashed border-blue-300":""),onDragOver:k,onDragEnter:C,onDragLeave:S,onDrop:O,children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"Files"}),(0,a.jsxs)("div",{children:[(0,a.jsx)(l.$,{size:"icon",variant:"outline",className:"mr-2",onClick:()=>p(!0),children:(0,a.jsx)(P.A,{className:"h-4 w-4"})}),(0,a.jsx)(l.$,{size:"icon",variant:"outline",onClick:()=>{var e;return null===(e=v.current)||void 0===e?void 0:e.click()},children:(0,a.jsx)(M.A,{className:"h-4 w-4"})}),(0,a.jsx)("input",{type:"file",ref:v,className:"hidden",onChange:e=>{var t;let s=null===(t=e.target.files)||void 0===t?void 0:t[0];s&&i(s)},accept:".txt,.md,.json"})]})]}),(0,a.jsx)("ul",{className:"space-y-2 flex-grow overflow-auto min-h-0",children:Object.keys(A).map(e=>(0,a.jsx)("li",{className:"flex items-center",children:(0,a.jsxs)(ei.jc,{openDelay:0,closeDelay:0,children:[(0,a.jsx)(ei.d0,{asChild:!0,children:(0,a.jsx)(l.$,{variant:e===t?"secondary":"ghost",className:"w-full justify-between ct-20",onClick:()=>s(e),children:e})}),(0,a.jsxs)(ei.Et,{side:"right",sideOffset:"-7",align:"end",className:"bg-red-100",children:[(0,a.jsx)(l.$,{variant:"ghost",size:"icon",onClick:()=>c(e),className:"hover:bg-black hover:text-white",children:(0,a.jsx)(B.A,{className:"h-4 w-4"})}),(0,a.jsx)(l.$,{variant:"ghost",size:"icon",onClick:()=>b(e),className:"hover:bg-black hover:text-white",children:(0,a.jsx)(eo.A,{className:"h-4 w-4"})})]})]})},e))}),(0,a.jsx)(ec,{isOpen:f,setIsOpen:h,warningMessage:ed.D.deleteFileWarningMessage,onConfirm:()=>N(f)}),(0,a.jsx)(eu,{isOpen:x,setIsOpen:p,newFileName:u,setNewFileName:m,handleAddFile:()=>{let e=u.trim(),t=(0,n.U)(e),s=(0,n.N)(e);return t.isValid?(null==A?void 0:A[s])?g(ed.D.fileExistWithSameName):void(o(s,""),m(""),g(""),p(!1)):g(t.error||"")},fileAddError:j})]})}var ef=s(7924),eh=s(4229),ex=s(2659),ep=s(1992),ej=s(7863);let eg=ep.bL;ep.YJ;let ev=ep.WT,eb=r.forwardRef((e,t)=>{let{className:s,children:r,...l}=e;return(0,a.jsxs)(ep.l9,{ref:t,className:(0,n.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",s),...l,children:[r,(0,a.jsx)(ep.In,{asChild:!0,children:(0,a.jsx)(F.A,{className:"h-4 w-4 opacity-50"})})]})});eb.displayName=ep.l9.displayName;let eN=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(ep.PP,{ref:t,className:(0,n.cn)("flex cursor-default items-center justify-center py-1",s),...r,children:(0,a.jsx)(ej.A,{className:"h-4 w-4"})})});eN.displayName=ep.PP.displayName;let ey=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(ep.wn,{ref:t,className:(0,n.cn)("flex cursor-default items-center justify-center py-1",s),...r,children:(0,a.jsx)(F.A,{className:"h-4 w-4"})})});ey.displayName=ep.wn.displayName;let ew=r.forwardRef((e,t)=>{let{className:s,children:r,position:l="popper",...o}=e;return(0,a.jsx)(ep.ZL,{children:(0,a.jsxs)(ep.UC,{ref:t,className:(0,n.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===l&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:l,...o,children:[(0,a.jsx)(eN,{}),(0,a.jsx)(ep.LM,{className:(0,n.cn)("p-1","popper"===l&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r}),(0,a.jsx)(ey,{})]})})});ew.displayName=ep.UC.displayName,r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(ep.JU,{ref:t,className:(0,n.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",s),...r})}).displayName=ep.JU.displayName;let ek=r.forwardRef((e,t)=>{let{className:s,children:r,...l}=e;return(0,a.jsxs)(ep.q7,{ref:t,className:(0,n.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...l,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(ep.VF,{children:(0,a.jsx)(b.A,{className:"h-4 w-4"})})}),(0,a.jsx)(ep.p4,{children:r})]})});function eC(){var e,t;let{currentProject:s,activeFile:n,currentFile:i,selectedTagFilter:u,searchTerm:m,setSearchTerm:x,handleTagFilterChange:j,handleContentChange:g,handleContextMenu:v,contextMenuPosition:b,setContextMenuPosition:N,uniqueTagLabels:k,addTag:C,handleNewTag:S,isNewTagDialogOpen:E,setIsNewTagDialogOpen:R,newTagLabel:L,setNewTagLabel:I,submitNewTag:z,renderContent:$,handleSearch:_,saveSearch:F,fetchSynonyms:D,searchResults:P,savedSearches:B,contentRef:M}=(0,r.useContext)(er),U=(null==s?void 0:s.marks)||{},W=k||[];return(0,a.jsxs)("div",{className:"flex-grow flex flex-col p-2 md:p-4 overflow-hidden",children:[(0,a.jsxs)("div",{className:"mb-4 flex flex-col md:flex-row gap-2",children:[(0,a.jsxs)(eg,{value:u,onValueChange:j,children:[(0,a.jsx)(eb,{className:"w-full md:w-[180px]",children:(0,a.jsx)(ev,{placeholder:"Filter tags..."})}),(0,a.jsxs)(ew,{children:[(0,a.jsx)(ek,{value:"all",children:"All Tags"}),W.map(e=>{var t;return(0,a.jsxs)(ek,{value:e,className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"w-3 h-3 rounded inline-block mr-2",style:{backgroundColor:null===(t=Object.values(U).find(t=>"Tag"===t.type&&t.name===e))||void 0===t?void 0:t.color}}),e]},e)})]})]}),(0,a.jsxs)("form",{onSubmit:_,className:"flex-1 flex gap-2",children:[(0,a.jsxs)("div",{className:"relative flex-1",children:[(0,a.jsx)(o,{type:"text",placeholder:"Search...",value:m,onChange:e=>x(e.target.value),className:"pr-8"}),m&&(0,a.jsx)(l.$,{type:"button",variant:"ghost",size:"icon",className:"absolute right-0 top-0 h-full",onClick:()=>x(""),children:(0,a.jsx)(c.A,{className:"h-4 w-4"})})]}),(0,a.jsx)(l.$,{type:"submit",children:(0,a.jsx)(ef.A,{className:"h-4 w-4"})}),(0,a.jsx)(l.$,{type:"button",onClick:F,disabled:!m||0===((null==P?void 0:P.length)||0)||(null==B?void 0:B.some(e=>e.name.toLowerCase()===m.toLowerCase()))||!1,children:(0,a.jsx)(eh.A,{className:"h-4 w-4"})}),(0,a.jsx)(l.$,{type:"button",onClick:D,disabled:!m,title:"Find synonyms",children:(0,a.jsx)(ex.A,{className:"h-4 w-4"})})]})]}),(0,a.jsx)("div",{ref:M,className:"text-lg p-4 border rounded relative whitespace-pre-wrap h-full overflow-auto",contentEditable:!0,suppressContentEditableWarning:!0,onInput:e=>g(e.currentTarget.textContent||""),onContextMenu:v,children:(null==i?void 0:i.content)?$():null}),(0,a.jsxs)(y,{open:!!b,onOpenChange:()=>N(null),children:[(0,a.jsx)(w,{asChild:!0,children:(0,a.jsx)("div",{style:{position:"fixed",left:null!==(e=null==b?void 0:b.x)&&void 0!==e?e:0,top:null!==(t=null==b?void 0:b.y)&&void 0!==t?t:0},onContextMenu:v})}),(0,a.jsxs)(O,{children:[W.map(e=>{var t;return(0,a.jsxs)(A,{onSelect:()=>C(e),className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"w-3 h-3 rounded",style:{backgroundColor:null===(t=Object.values(U).find(t=>"Tag"===t.type&&t.name===e))||void 0===t?void 0:t.color}}),e]},e)}),W.length>0&&(0,a.jsx)(T,{}),(0,a.jsx)(A,{onSelect:S,children:"New Tag..."})]})]}),(0,a.jsx)(d,{open:E,onOpenChange:R,children:(0,a.jsxs)(f,{children:[(0,a.jsx)(h,{children:(0,a.jsx)(p,{children:"Create New Tag"})}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(o,{type:"text",placeholder:"Enter new tag label",value:L,onChange:e=>I(e.target.value)}),(0,a.jsx)(l.$,{onClick:z,children:"Add"})]})]})})]})}ek.displayName=ep.q7.displayName,r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(ep.wv,{ref:t,className:(0,n.cn)("-mx-1 my-1 h-px bg-muted",s),...r})}).displayName=ep.wv.displayName;var eS=s(8482),eO=s(5204),eA=s(6891),eE=s(5448),eT=s(7808);function eR(e){let{tags:t,onTagClick:s,onOccurrenceClick:r,onRemoveTag:n,onRemoveOccurrence:o,highlightedTag:i,activeFile:c}=e;return(0,a.jsxs)(eS.Zp,{className:"w-full h-full flex flex-col",children:[(0,a.jsx)(eS.aR,{children:(0,a.jsxs)(eS.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(eE.A,{className:"h-5 w-5"}),"Tag Analysis"]})}),(0,a.jsx)(eS.Wu,{className:"flex-1 overflow-hidden",children:(0,a.jsx)(eA.F,{className:"h-full pr-4",children:(0,a.jsx)("div",{className:"space-y-4",children:t.map(e=>{let t=e.positions[c]||[],d=t.length;return(0,a.jsxs)(eO.Nt,{children:[(0,a.jsx)(eO.R6,{asChild:!0,children:(0,a.jsxs)("div",{className:"flex w-full items-center gap-2 rounded-lg border bg-card p-4 text-left hover:bg-accent ".concat(i===e.text?"bg-green-200":""),children:[(0,a.jsx)(v.A,{className:"h-4 w-4 shrink-0 transition-transform duration-200 ".concat(i===e.text?"rotate-90":"")}),(0,a.jsx)("div",{className:"h-3 w-3 rounded",style:{backgroundColor:e.color}}),(0,a.jsx)("span",{className:"font-semibold",onClick:()=>s(e.text),children:e.text}),(0,a.jsxs)("span",{className:"ml-auto rounded-full bg-muted px-2 py-0.5 text-sm text-muted-foreground",children:[d," ",1===d?"occurrence":"occurrences"]}),(0,a.jsx)(l.$,{variant:"ghost",size:"icon",className:"ml-1 h-6 w-6",onClick:t=>{t.stopPropagation(),n(e.id)},children:(0,a.jsx)(eo.A,{className:"h-3 w-3"})})]})}),(0,a.jsx)(eO.Ke,{className:"mt-2 space-y-2",children:t.map((t,n)=>(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(eT.$,{text:t.text,start:t.start,stop:t.stop,isHighlighted:i===e.text,onClick:()=>{s(e.text),r(t)}}),(0,a.jsx)(l.$,{variant:"ghost",size:"icon",className:"absolute top-2 right-2 h-6 w-6",onClick:()=>o(e.id,t),children:(0,a.jsx)(eo.A,{className:"h-3 w-3"})})]},n))})]},e.id)})})})})]})}var eL=s(3904),eI=s(9676);function ez(e){let{currentSearchResults:t,savedSearches:s,onSelectSearch:n,onSelectSpecificSearch:o,onRemoveSearch:i,onRefreshAllSearches:u,highlightedSearch:m,activeFile:j}=e,{refreshAllSearches:g,isRefreshingSearch:b,setIsRefreshingSearch:N}=(0,r.useContext)(er);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(eS.Zp,{className:"w-full h-full flex flex-col",children:[(0,a.jsx)(eS.aR,{children:(0,a.jsxs)(eS.ZB,{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(ef.A,{className:"h-5 w-5"}),"Search Analysis"]}),u&&(0,a.jsxs)(l.$,{variant:"outline",size:"sm",onClick:()=>{g()},title:"Refresh searches for all files",children:[(0,a.jsx)(eL.A,{className:"h-4 w-4 mr-1"}),"Refresh All"]})]})}),(0,a.jsx)(eS.Wu,{className:"flex-1 overflow-hidden",children:(0,a.jsx)(eA.F,{className:"h-full pr-4",children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)(eO.Nt,{children:[(0,a.jsxs)(eO.R6,{className:"flex w-full items-center gap-2 rounded-lg border bg-card p-4 text-left hover:bg-accent",children:[(0,a.jsx)(v.A,{className:"h-4 w-4 shrink-0 transition-transform duration-200 group-data-[state=open]:rotate-90"}),(0,a.jsx)(ef.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"font-semibold",children:"Current Search"}),(0,a.jsxs)("span",{className:"ml-auto rounded-full bg-muted px-2 py-0.5 text-sm text-muted-foreground",children:[t.length," ",1===t.length?"result":"results"]})]}),(0,a.jsx)(eO.Ke,{className:"mt-2 space-y-2",children:t.map((e,t)=>(0,a.jsx)(eT.$,{text:e.text,start:e.start,stop:e.stop,isHighlighted:m===e.text,onClick:()=>o(e)},t))})]}),(0,a.jsxs)(eO.Nt,{children:[(0,a.jsxs)(eO.R6,{className:"flex w-full items-center gap-2 rounded-lg border bg-card p-4 text-left hover:bg-accent",children:[(0,a.jsx)(v.A,{className:"h-4 w-4 shrink-0 transition-transform duration-200 group-data-[state=open]:rotate-90"}),(0,a.jsx)(eI.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"font-semibold",children:"Saved Searches"}),(0,a.jsxs)("span",{className:"ml-auto rounded-full bg-muted px-2 py-0.5 text-sm text-muted-foreground",children:[s.length," ",1===s.length?"search":"searches"]})]}),(0,a.jsx)(eO.Ke,{className:"mt-2 space-y-2",children:s.map((e,t)=>(0,a.jsxs)(eO.Nt,{children:[(0,a.jsxs)(eO.R6,{className:"flex w-full items-center gap-2 rounded-lg border bg-card p-4 text-left hover:bg-accent ".concat(m===e.text?"bg-green-200":""),onClick:()=>n(e.text),children:[(0,a.jsx)(v.A,{className:"h-4 w-4 shrink-0 transition-transform duration-200 group-data-[state=open]:rotate-90"}),(0,a.jsx)(ef.A,{className:"h-4 w-4 text-muted-foreground"}),(0,a.jsx)("span",{children:e.text}),(0,a.jsxs)("span",{className:"ml-auto rounded-full bg-muted px-2 py-0.5 text-sm text-muted-foreground",children:[e.occurrences.length," ",1===e.occurrences.length?"occurrence":"occurrences"]}),(0,a.jsx)(l.$,{size:"icon",variant:"ghost",className:"ml-2 h-6 w-6",onClick:t=>{t.stopPropagation(),i(e.text)},children:(0,a.jsx)(c.A,{className:"h-4 w-4"})})]}),(0,a.jsx)(eO.Ke,{className:"mt-2 space-y-2",children:e.occurrences.map((t,s)=>(0,a.jsx)(eT.$,{text:t.text,start:t.start,stop:t.stop,isHighlighted:m===e.text,onClick:()=>{n(e.text),o(t)}},s))})]},t))})]})]})})})]}),(0,a.jsx)(d,{open:b,onOpenChange:N,children:(0,a.jsxs)(f,{children:[(0,a.jsx)(h,{children:(0,a.jsx)(p,{children:"Refreshing Searches"})}),(0,a.jsxs)("div",{className:"py-4 text-center",children:[(0,a.jsx)(eL.A,{className:"h-8 w-8 animate-spin mx-auto mb-4"}),(0,a.jsx)("p",{children:"Refreshing all searches across all files..."})]}),(0,a.jsx)(x,{children:(0,a.jsx)(l.$,{onClick:()=>N(!1),children:"OK"})})]})})]})}var e$=s(704);let e_=e$.bL,eF=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(e$.B8,{ref:t,className:(0,n.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",s),...r})});eF.displayName=e$.B8.displayName;let eD=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(e$.l9,{ref:t,className:(0,n.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",s),...r})});eD.displayName=e$.l9.displayName;let eP=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(e$.UC,{ref:t,className:(0,n.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...r})});eP.displayName=e$.UC.displayName;var eB=s(6981);let eM=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(eB.bL,{ref:t,className:(0,n.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",s),...r,children:(0,a.jsx)(eB.C1,{className:(0,n.cn)("flex items-center justify-center text-current"),children:(0,a.jsx)(b.A,{className:"h-4 w-4"})})})});eM.displayName=eB.bL.displayName;var eU=s(3717),eW=s(2525),eV=s(3332);function eZ(){let{groups:e,currentProject:t,newGroupName:s,setNewGroupName:n,isNewGroupDialogOpen:i,setIsNewGroupDialogOpen:c,isEditGroupDialogOpen:u,setIsEditGroupDialogOpen:m,selectedGroupForEdit:j,setSelectedGroupForEdit:g,createGroup:v,deleteGroup:b,getMarksByGroup:N,updateGroupMarks:y}=(0,r.useContext)(er),[w,k]=(0,r.useState)([]),[C,S]=(0,r.useState)([]);(0,r.useEffect)(()=>{let e=[];Object.entries(t.marks||{}).forEach(t=>{let[s,a]=t;e.push({id:s,name:a.name,type:a.type})}),k(e)},[t.marks]),(0,r.useEffect)(()=>{j&&u?S(N(j).map(e=>e.id)):S([])},[j,u,N]);let O=e=>{confirm("Are you sure you want to delete this group?")&&b(e)},A=e=>{g(e),m(!0)},E=e=>{S(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(eS.Zp,{className:"w-full",children:[(0,a.jsx)(eS.aR,{children:(0,a.jsxs)(eS.ZB,{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{children:"Groups"}),(0,a.jsxs)(l.$,{size:"sm",onClick:()=>c(!0),children:[(0,a.jsx)(P.A,{className:"h-4 w-4 mr-1"}),"New Group"]})]})}),(0,a.jsx)(eS.Wu,{children:(0,a.jsx)(eA.F,{className:"h-[300px] pr-4",children:0===e.length?(0,a.jsxs)("div",{className:"text-center text-muted-foreground py-8",children:[(0,a.jsx)("p",{children:"No groups created yet."}),(0,a.jsx)("p",{className:"text-sm",children:"Create a group to organize your tags and searches."})]}):(0,a.jsx)("div",{className:"space-y-4",children:e.map(e=>{let t=N(e.id),s=t.filter(e=>"Tag"===e.type).length,r=t.filter(e=>"Search"===e.type).length;return(0,a.jsxs)("div",{className:"rounded-lg border p-4 hover:bg-accent/5 transition-colors",style:{borderLeftColor:e.color,borderLeftWidth:"4px"},children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("h3",{className:"font-medium",children:e.name}),(0,a.jsxs)("div",{className:"flex gap-1",children:[(0,a.jsx)(l.$,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>A(e.id),children:(0,a.jsx)(eU.A,{className:"h-4 w-4"})}),(0,a.jsx)(l.$,{variant:"ghost",size:"icon",className:"h-8 w-8 text-destructive",onClick:()=>O(e.id),children:(0,a.jsx)(eW.A,{className:"h-4 w-4"})})]})]}),(0,a.jsxs)("div",{className:"flex gap-3 text-sm text-muted-foreground",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(eV.A,{className:"h-3.5 w-3.5 mr-1"}),s," ",1===s?"tag":"tags"]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(ef.A,{className:"h-3.5 w-3.5 mr-1"}),r," ",1===r?"search":"searches"]})]}),t.length>0&&(0,a.jsx)("div",{className:"mt-2 flex flex-wrap gap-1",children:t.map(e=>(0,a.jsx)("div",{className:"inline-flex items-center rounded-full px-2 py-0.5 text-xs",style:{backgroundColor:e.color,color:"#fff"},children:e.name},e.id))})]},e.id)})})})})]}),(0,a.jsx)(d,{open:i,onOpenChange:c,children:(0,a.jsxs)(f,{children:[(0,a.jsx)(h,{children:(0,a.jsx)(p,{children:"Create New Group"})}),(0,a.jsx)("div",{className:"py-4",children:(0,a.jsx)(o,{placeholder:"Group name",value:s,onChange:e=>n(e.target.value)})}),(0,a.jsxs)(x,{children:[(0,a.jsx)(l.$,{variant:"outline",onClick:()=>c(!1),children:"Cancel"}),(0,a.jsx)(l.$,{onClick:()=>{s.trim()&&(v(s),n(""),c(!1))},disabled:!s.trim(),children:"Create"})]})]})}),(0,a.jsx)(d,{open:u,onOpenChange:m,children:(0,a.jsxs)(f,{className:"max-w-md",children:[(0,a.jsx)(h,{children:(0,a.jsx)(p,{children:"Edit Group"})}),(0,a.jsxs)(e_,{defaultValue:"tags",children:[(0,a.jsxs)(eF,{className:"grid w-full grid-cols-2",children:[(0,a.jsx)(eD,{value:"tags",children:"Tags"}),(0,a.jsx)(eD,{value:"searches",children:"Searches"})]}),(0,a.jsx)(eP,{value:"tags",className:"mt-4",children:(0,a.jsx)(eA.F,{className:"h-[300px] pr-4",children:(0,a.jsx)("div",{className:"space-y-2",children:w.filter(e=>"Tag"===e.type).map(e=>(0,a.jsxs)("div",{className:"flex items-center space-x-2 p-2 rounded hover:bg-accent",children:[(0,a.jsx)(eM,{id:"tag-".concat(e.id),checked:C.includes(e.id),onCheckedChange:()=>E(e.id)}),(0,a.jsx)("label",{htmlFor:"tag-".concat(e.id),className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 cursor-pointer flex-1",children:e.name})]},e.id))})})}),(0,a.jsx)(eP,{value:"searches",className:"mt-4",children:(0,a.jsx)(eA.F,{className:"h-[300px] pr-4",children:(0,a.jsx)("div",{className:"space-y-2",children:w.filter(e=>"Search"===e.type).map(e=>(0,a.jsxs)("div",{className:"flex items-center space-x-2 p-2 rounded hover:bg-accent",children:[(0,a.jsx)(eM,{id:"search-".concat(e.id),checked:C.includes(e.id),onCheckedChange:()=>E(e.id)}),(0,a.jsx)("label",{htmlFor:"search-".concat(e.id),className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 cursor-pointer flex-1",children:e.name})]},e.id))})})})]}),(0,a.jsxs)(x,{children:[(0,a.jsx)(l.$,{variant:"outline",onClick:()=>m(!1),children:"Cancel"}),(0,a.jsx)(l.$,{onClick:()=>{j&&(y(j,C),m(!1),g(null))},children:"Save Changes"})]})]})})]})}function eJ(){let{prepareTagsForAnalysis:e,prepareSearchesForAnalysis:t,handleTagClick:s,handleSpecificSearchClick:l,selectedTagFilter:n,activeFile:o,searchTerm:i,searchResults:c,handleSearchClick:d,handleRemoveSearch:u,handleRemoveTag:m,handleRemoveOccurrence:f}=(0,r.useContext)(er),h=e()||[],x=t()||[],[p,j]=(0,r.useState)(.5),g=(0,r.useRef)(null),v=(0,r.useCallback)(e=>{e.preventDefault();let t=e.clientY,s=g.current;if(!s)return;let a=s.getBoundingClientRect(),r=e=>{let s=e.clientY-t,r=(p*a.height+s)/a.height;j(r=Math.max(.1,Math.min(.9,r)))},l=()=>{window.removeEventListener("mousemove",r),window.removeEventListener("mouseup",l)};window.addEventListener("mousemove",r),window.addEventListener("mouseup",l)},[p]);return(0,a.jsx)("div",{className:"border-l p-2 md:p-4 h-full flex flex-col",children:(0,a.jsxs)(e_,{defaultValue:"analysis",className:"flex flex-col h-full",children:[(0,a.jsxs)(eF,{className:"w-full mb-4",children:[(0,a.jsx)(eD,{value:"analysis",className:"flex-1",children:"Analysis"}),(0,a.jsx)(eD,{value:"groups",className:"flex-1",children:"Groups"})]}),(0,a.jsx)(eP,{value:"analysis",className:"p-0 flex-1 overflow-hidden",children:(0,a.jsxs)("div",{ref:g,className:"flex flex-col h-full",children:[(0,a.jsx)("div",{style:{flexGrow:p,flexShrink:1,flexBasis:0},className:"overflow-auto min-h-0",children:(0,a.jsx)(eR,{tags:h,onTagClick:s,onOccurrenceClick:l,onRemoveTag:m,onRemoveOccurrence:f,highlightedTag:n,activeFile:o})}),(0,a.jsx)("div",{className:"h-1 bg-gray-200 hover:bg-gray-300 cursor-row-resize",onMouseDown:v}),(0,a.jsx)("div",{style:{flexGrow:1-p,flexShrink:1,flexBasis:0},className:"overflow-auto min-h-0",children:(0,a.jsx)(ez,{currentSearchResults:(c||[]).map(e=>({text:e.text||"",start:e.start||0,stop:e.end||0})),savedSearches:x,onSelectSearch:d,onSelectSpecificSearch:l,onRemoveSearch:u,highlightedSearch:i,activeFile:o,onRefreshAllSearches:!0})})]})}),(0,a.jsx)(eP,{value:"groups",className:"flex-1 overflow-auto",children:(0,a.jsx)(eZ,{})})]})})}function eK(){let{apiKey:e,showApiKeyDialog:t,setShowApiKeyDialog:s,handleSaveApiKey:n}=(0,r.useContext)(er),[i,c]=(0,r.useState)(e||"");return(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(d,{open:t,onOpenChange:s,children:(0,a.jsxs)(f,{children:[(0,a.jsx)(h,{children:(0,a.jsx)(p,{children:"Enter OpenAI API Key"})}),(0,a.jsxs)("div",{className:"flex flex-col space-y-2",children:[(0,a.jsx)(o,{type:"password",placeholder:"sk-...",value:i,onChange:e=>c(e.target.value)}),(0,a.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,a.jsx)(l.$,{variant:"outline",onClick:()=>s(!1),children:"Cancel"}),(0,a.jsx)(l.$,{onClick:()=>{if(!i.trim()){ee({title:"Invalid Key",description:"Please enter a non-empty API key.",variant:"destructive"});return}n(i.trim())},children:"Save"})]})]})]})})})}function eG(e){let{children:t}=e,{currentProject:s}=(0,r.useContext)(er),[l,n]=(0,r.useState)(300),[o,i]=(0,r.useState)(300);return s?(0,a.jsxs)("div",{className:"flex flex-col h-screen max-w-full",children:[(0,a.jsx)(en,{}),(0,a.jsx)(eK,{}),(0,a.jsxs)("div",{className:"flex flex-1 overflow-hidden",children:[(0,a.jsx)("div",{style:{width:l},className:"flex-shrink-0 overflow-auto min-h-0",children:(0,a.jsx)(em,{})}),(0,a.jsx)("div",{className:"w-1 bg-gray-200 cursor-col-resize hover:bg-gray-300",onMouseDown:e=>{e.preventDefault();let t=e.clientX,s=e=>{n(Math.max(150,l+(e.clientX-t)))},a=()=>{window.removeEventListener("mousemove",s),window.removeEventListener("mouseup",a)};window.addEventListener("mousemove",s),window.addEventListener("mouseup",a)}}),(0,a.jsx)("div",{className:"flex-1 min-w-0 overflow-auto",children:(0,a.jsx)(eC,{})}),(0,a.jsx)("div",{className:"w-1 bg-gray-200 cursor-col-resize hover:bg-gray-300",onMouseDown:e=>{e.preventDefault();let t=e.clientX,s=e=>{i(Math.max(150,o-(e.clientX-t)))},a=()=>{window.removeEventListener("mousemove",s),window.removeEventListener("mouseup",a)};window.addEventListener("mousemove",s),window.addEventListener("mouseup",a)}}),(0,a.jsx)("div",{style:{width:o},className:"flex-shrink-0 overflow-auto",children:(0,a.jsx)(eJ,{})})]}),t]}):(0,a.jsx)("div",{children:"Loading..."})}var eH=s(1154);function eY(e){let{word:t,synonyms:s,isLoading:n,onClose:o,onSave:i}=e,[c,u]=(0,r.useState)([]),m=e=>{u(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},x=s.length>0?s:["sample","text","part","click","tags"];return(0,a.jsx)(d,{open:!0,onOpenChange:o,children:(0,a.jsxs)(f,{className:"sm:max-w-md",children:[(0,a.jsx)(h,{children:(0,a.jsxs)(p,{children:['Synonyms for "',t,'"']})}),n?(0,a.jsxs)("div",{className:"flex justify-center items-center py-8",children:[(0,a.jsx)(eH.A,{className:"h-8 w-8 animate-spin text-primary"}),(0,a.jsx)("span",{className:"ml-2",children:"Fetching synonyms..."})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex justify-between mb-2",children:[(0,a.jsx)(l.$,{variant:"outline",size:"sm",onClick:()=>{u(s)},children:"Select All"}),(0,a.jsx)(l.$,{variant:"outline",size:"sm",onClick:()=>{u([])},children:"Deselect All"})]}),(0,a.jsx)(eA.F,{className:"h-[300px] pr-4",children:(0,a.jsx)("div",{className:"space-y-2",children:x.map(e=>(0,a.jsxs)("div",{className:"flex items-center space-x-2 p-2 rounded hover:bg-accent",children:[(0,a.jsx)(eM,{id:"synonym-".concat(e),checked:c.includes(e),onCheckedChange:()=>m(e)}),(0,a.jsx)("label",{htmlFor:"synonym-".concat(e),className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 cursor-pointer flex-1",children:e})]},e))})}),(0,a.jsxs)("div",{className:"flex justify-end space-x-2 mt-4",children:[(0,a.jsx)(l.$,{variant:"outline",onClick:o,children:"Cancel"}),(0,a.jsxs)(l.$,{onClick:()=>{i(c)},disabled:0===c.length,children:["Save ",c.length>0&&"(".concat(c.length,")")]})]})]})]})})}function eX(){let{showSynonymsPopup:e,setShowSynonymsPopup:t,searchTerm:s,synonyms:l,isFetchingSynonyms:n,handleSaveSynonyms:o}=(0,r.useContext)(er);return e?(0,a.jsx)(eY,{word:s,synonyms:l,isLoading:n,onClose:()=>t(!1),onSave:o}):null}var eq=s(81),eQ=s(7740);let e0=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(eQ.uB,{ref:t,className:(0,n.cn)("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",s),...r})});e0.displayName=eQ.uB.displayName;let e1=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsxs)("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[(0,a.jsx)(ef.A,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),(0,a.jsx)(eQ.uB.Input,{ref:t,className:(0,n.cn)("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",s),...r})]})});e1.displayName=eQ.uB.Input.displayName;let e2=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(eQ.uB.List,{ref:t,className:(0,n.cn)("max-h-[300px] overflow-y-auto overflow-x-hidden",s),...r})});e2.displayName=eQ.uB.List.displayName;let e4=r.forwardRef((e,t)=>(0,a.jsx)(eQ.uB.Empty,{ref:t,className:"py-6 text-center text-sm",...e}));e4.displayName=eQ.uB.Empty.displayName;let e5=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(eQ.uB.Group,{ref:t,className:(0,n.cn)("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",s),...r})});e5.displayName=eQ.uB.Group.displayName,r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(eQ.uB.Separator,{ref:t,className:(0,n.cn)("-mx-1 h-px bg-border",s),...r})}).displayName=eQ.uB.Separator.displayName;let e8=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(eQ.uB.Item,{ref:t,className:(0,n.cn)("relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",s),...r})});e8.displayName=eQ.uB.Item.displayName;var e3=s(547);let e9=e3.bL,e6=e3.l9,e7=r.forwardRef((e,t)=>{let{className:s,align:r="center",sideOffset:l=4,...o}=e;return(0,a.jsx)(e3.ZL,{children:(0,a.jsx)(e3.UC,{ref:t,align:r,sideOffset:l,className:(0,n.cn)("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...o})})});function te(e){let{options:t,selected:s,onChange:o,placeholder:i}=e,[c,d]=r.useState(!1),u=r.useCallback(e=>{d(!1),o(s.includes(e)?s.filter(t=>t!==e):[...s,e])},[s,o]);return(0,a.jsxs)(e9,{open:c,onOpenChange:d,children:[(0,a.jsx)(e6,{asChild:!0,children:(0,a.jsxs)(l.$,{variant:"outline",role:"combobox","aria-expanded":c,className:"w-full justify-between",children:[s.length>0?"".concat(s.length," selected"):i||"Select items...",(0,a.jsx)(eq.A,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),(0,a.jsx)(e7,{className:"w-full p-0",children:(0,a.jsxs)(e0,{children:[(0,a.jsx)(e1,{placeholder:"Search items..."}),(0,a.jsxs)(e2,{children:[(0,a.jsx)(e4,{children:"No item found."}),(0,a.jsx)(e5,{className:"max-h-64 overflow-auto",children:t.map(e=>(0,a.jsxs)(e8,{onSelect:()=>u(e),children:[(0,a.jsx)(b.A,{className:(0,n.cn)("mr-2 h-4 w-4",s.includes(e)?"opacity-100":"opacity-0")}),e]},e))})]})]})})]})}e7.displayName=e3.UC.displayName;let tt=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{className:"relative w-full overflow-auto",children:(0,a.jsx)("table",{ref:t,className:(0,n.cn)("w-full caption-bottom text-sm",s),...r})})});tt.displayName="Table";let ts=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("thead",{ref:t,className:(0,n.cn)("[&_tr]:border-b",s),...r})});ts.displayName="TableHeader";let ta=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("tbody",{ref:t,className:(0,n.cn)("[&_tr:last-child]:border-0",s),...r})});ta.displayName="TableBody",r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("tfoot",{ref:t,className:(0,n.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",s),...r})}).displayName="TableFooter";let tr=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("tr",{ref:t,className:(0,n.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",s),...r})});tr.displayName="TableRow";let tl=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("th",{ref:t,className:(0,n.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",s),...r})});tl.displayName="TableHead";let tn=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("td",{ref:t,className:(0,n.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",s),...r})});function to(){let{showTabulationView:e,setShowTabulationView:t,currentProject:s,activeFile:l,handleSpecificSearchClick:n,getAllMarksForTabulation:o}=(0,r.useContext)(er);if(!e)return null;let i=(null==s?void 0:s.files)||{},c=(null==s?void 0:s.marks)||{},d=(null==s?void 0:s.groups)||{},u=o(),m={markOptions:u.map(e=>"".concat(e.prefix," - ").concat(e.name)),files:Object.keys(i),activeFile:l,getOccurrences:(e,t)=>{let[s,...a]=e.split(" - "),r=a.join(" - "),l=u.find(e=>e.prefix===s&&e.name===r);if(!l)return[];if("Group"===s){let e=d[l.id];if(!e)return[];let s=[];return(e.marks||[]).forEach(e=>{if(!c[e])return;let a=i[t];if(!a)return;let r=(a.occurrences||[]).filter(t=>t.id===e).map(e=>({text:e.text||"",start:e.start||0,end:e.end||0,file:t}));s.push(...r)}),s}let n=l.id,o=i[t];return o?(o.occurrences||[]).filter(e=>e.id===n).map(e=>({text:e.text||"",start:e.start||0,end:e.end||0,file:t})):[]}};return(0,a.jsx)(ti,{data:m,onClose:()=>t(!1),onSelectOccurrence:e=>{n(e),t(!1)}})}function ti(e){let{data:t,onClose:s,onSelectOccurrence:n}=e,{tabulationRowSelections:o,setTabulationRowSelections:i,tabulationColumnSelections:u,setTabulationColumnSelections:m,tabulationExpansionType:x,setTabulationExpansionType:j}=(0,r.useContext)(er),[g,v]=(0,r.useState)(null),[b,N]=(0,r.useState)(null),{currentProject:y,setActiveFile:w,setSelectedTagFilter:k,setSearchTerm:C}=(0,r.useContext)(er),S=(0,r.useMemo)(()=>{if(0===o.length||0===u.length)return null;let e={};return o.forEach(t=>{e[t]={},u.forEach(s=>{e[t][s]={count:0,occurrences:[]}}),e[t].Total={count:0,occurrences:[]}}),e.Total={},u.forEach(t=>{e.Total[t]={count:0,occurrences:[]}}),e.Total.Total={count:0,occurrences:[]},t.files.forEach(s=>{var a;let r;let l=(null===(a=y.files[s])||void 0===a?void 0:a.content)||"",n=[],i=/[^.!?]+[.!?]*/g;for(;null!==(r=i.exec(l));)n.push({start:r.index,end:r.index+r[0].length});let c=[],d=l.split(/\r?\n\r?\n/),m=0;d.forEach(e=>{let t=l.indexOf(e,m);-1!==t&&(c.push({start:t,end:t+e.length}),m=t+e.length)}),o.forEach(a=>{let r=t.getOccurrences(a,s);u.forEach(l=>{let o=t.getOccurrences(l,s),i=r.filter(e=>o.some(t=>{if(0===x)return Math.max(e.start,t.start)<Math.min(e.end,t.end);if(1===x){let s=n.find(t=>e.start>=t.start&&e.end<=t.end),a=n.find(e=>t.start>=e.start&&t.end<=e.end);return void 0!==s&&s===a}{let s=c.find(t=>e.start>=t.start&&e.end<=t.end),a=c.find(e=>t.start>=e.start&&t.end<=e.end);return void 0!==s&&s===a}}));e[a][l].count+=i.length,e[a][l].occurrences.push(...i),e[a].Total.count+=i.length,e.Total[l].count+=i.length,e.Total.Total.count+=i.length})})}),e},[o,u,x,t]),O=(0,r.useCallback)(()=>{if(!S)return;let e=new Blob([[["Intersection",...u,"Total"],...o.map(e=>[e,...u.map(t=>S[e][t].count),S[e].Total.count]),["Total",...u.map(e=>S.Total[e].count),S.Total.Total.count]].map(e=>e.join(",")).join("\n")],{type:"text/csv;charset=utf-8;"}),t=document.createElement("a");if(void 0!==t.download){let s=URL.createObjectURL(e);t.setAttribute("href",s),t.setAttribute("download","tabulation.csv"),t.style.visibility="hidden",document.body.appendChild(t),t.click(),document.body.removeChild(t)}},[S,o,u]),A=(0,r.useCallback)(e=>{if(N(e),w(e.file),g){let[e,...t]=g.row.split(" - "),s=t.join(" - ");"Tag"===e?k(s):"Search"===e&&C(s)}n(e)},[n,g,w,k,C]);return 0===t.files.length?(0,a.jsxs)(eS.Zp,{className:"fixed inset-0 z-50 flex flex-col",children:[(0,a.jsx)(eS.aR,{className:"flex-shrink-0",children:(0,a.jsxs)(eS.ZB,{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{children:"Tabulation View"}),(0,a.jsx)(l.$,{variant:"ghost",size:"icon",onClick:s,children:(0,a.jsx)(c.A,{className:"h-4 w-4"})})]})}),(0,a.jsx)(eS.Wu,{className:"flex-grow overflow-auto",children:(0,a.jsx)("div",{className:"text-center text-muted-foreground",children:"No files available for tabulation."})})]}):(0,a.jsxs)(eS.Zp,{className:"fixed inset-0 z-50 flex flex-col",children:[(0,a.jsx)(eS.aR,{className:"flex-shrink-0",children:(0,a.jsxs)(eS.ZB,{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{children:"Tabulation View"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(l.$,{variant:"outline",onClick:O,disabled:!S,children:[(0,a.jsx)(B.A,{className:"h-4 w-4 mr-2"}),"Export to CSV"]}),(0,a.jsx)(l.$,{variant:"ghost",size:"icon",onClick:s,children:(0,a.jsx)(c.A,{className:"h-4 w-4"})})]})]})}),(0,a.jsx)(eS.Wu,{className:"flex-grow overflow-auto",children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex flex-wrap gap-4",children:[(0,a.jsxs)("div",{className:"flex-1 min-w-[250px]",children:[(0,a.jsx)("label",{className:"text-sm font-medium mb-1 block",children:"Row Items"}),(0,a.jsx)(te,{options:t.markOptions,selected:o,onChange:i,placeholder:"Select row items"})]}),(0,a.jsxs)("div",{className:"flex-1 min-w-[250px]",children:[(0,a.jsx)("label",{className:"text-sm font-medium mb-1 block",children:"Column Items"}),(0,a.jsx)(te,{options:t.markOptions,selected:u,onChange:m,placeholder:"Select column items"})]}),(0,a.jsxs)("div",{className:"min-w-[180px]",children:[(0,a.jsx)("label",{className:"text-sm font-medium mb-1 block",children:"Extend Search Type"}),(0,a.jsxs)(eg,{value:x.toString(),onValueChange:e=>j(Number.parseInt(e)),children:[(0,a.jsx)(eb,{children:(0,a.jsx)(ev,{placeholder:"Select expansion type"})}),(0,a.jsxs)(ew,{children:[(0,a.jsx)(ek,{value:"0",children:"No Expand"}),(0,a.jsx)(ek,{value:"1",children:"Sentence Expand"}),(0,a.jsx)(ek,{value:"2",children:"Paragraph Expand"})]})]})]})]}),S?(0,a.jsx)("div",{className:"overflow-auto",children:(0,a.jsxs)(tt,{children:[(0,a.jsx)(ts,{children:(0,a.jsxs)(tr,{children:[(0,a.jsx)(tl,{className:"w-[200px]",children:"Intersection"}),u.map(e=>(0,a.jsx)(tl,{children:e},e)),(0,a.jsx)(tl,{children:"Total"})]})}),(0,a.jsxs)(ta,{children:[o.map(e=>(0,a.jsxs)(tr,{children:[(0,a.jsx)(tn,{className:"font-medium",children:e}),u.map(t=>(0,a.jsx)(tn,{className:"cursor-pointer hover:bg-muted",onClick:()=>v({row:e,col:t}),children:S[e][t].count},t)),(0,a.jsx)(tn,{children:S[e].Total.count})]},e)),(0,a.jsxs)(tr,{children:[(0,a.jsx)(tn,{className:"font-medium",children:"Total"}),u.map(e=>(0,a.jsx)(tn,{children:S.Total[e].count},e)),(0,a.jsx)(tn,{children:S.Total.Total.count})]})]})]})}):(0,a.jsx)("div",{className:"text-center text-muted-foreground",children:"Select row and column items to generate the tabulation."})]})}),g&&S&&(0,a.jsx)(d,{open:!!g,onOpenChange:()=>v(null),children:(0,a.jsxs)(f,{children:[(0,a.jsx)(h,{children:(0,a.jsxs)(p,{children:["Occurrences for ",g.row," ∩ ",g.col]})}),(0,a.jsx)(eA.F,{className:"h-[300px]",children:S[g.row][g.col].occurrences.map((e,t)=>(0,a.jsx)("div",{className:"mb-4",children:(0,a.jsx)(eT.$,{text:e.text,start:e.start,stop:e.end,isHighlighted:(null==b?void 0:b.start)===e.start&&(null==b?void 0:b.end)===e.end,onClick:()=>A(e),fileId:e.file})},t))})]})})]})}function tc(){return(0,a.jsx)(el,{children:(0,a.jsxs)(eG,{children:[(0,a.jsx)(eX,{}),(0,a.jsx)(to,{})]})})}tn.displayName="TableCell",r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("caption",{ref:t,className:(0,n.cn)("mt-4 text-sm text-muted-foreground",s),...r})}).displayName="TableCaption"}},e=>{var t=t=>e(e.s=t);e.O(0,[543,223,441,684,358],()=>t(5041)),_N_E=e.O()}]);